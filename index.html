<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SCL-90 心理健康自评量表</title>
    <style>
        :root {
            /*在这里修改颜色，目前是治愈绿 */
            --primary-color: #42b983; 
            --bg-color: #f5f7fa;
            --card-bg: #ffffff;
            --text-color: #333333;
            --secondary-text: #666666;
            --success: #2ecc71;
            --warning: #f1c40f;
            --danger: #e74c3c;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* 欢迎页与结果页 */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            text-align: center;
        }

        h1, h2 {
            margin-top: 0;
            color: var(--primary-color);
        }

        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
            transition: background 0.3s;
            -webkit-tap-highlight-color: transparent;
        }

        .btn:active {
            opacity: 0.8;
        }

        /* 进度条 */
        .progress-container {
            margin-bottom: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: right;
            font-size: 12px;
            color: var(--secondary-text);
            margin-top: -15px;
            margin-bottom: 15px;
        }

        /* 题目区域 */
        #quiz-section {
            display: none;
            flex: 1;
        }

        .question-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .question-text {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 24px;
            flex-grow: 1;
        }

        .options-grid {
            display: grid;
            gap: 12px;
        }

        .option-btn {
            background: #f0f2f5;
            border: 1px solid #e1e4e8;
            padding: 15px;
            border-radius: 8px;
            text-align: left;
            cursor: pointer;
            font-size: 15px;
            transition: all 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .option-btn:active, .option-btn.selected {
            background: #eafff6; /* 点击时的背景色也微调了 */
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        /* 结果区域 */
        #result-section {
            display: none;
        }

        .result-item {
            margin-bottom: 15px;
            text-align: left;
        }

        .result-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 14px;
            font-weight: 500;
        }

        .result-bar-bg {
            background: #eee;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
        }

        .result-bar-fill {
            height: 100%;
            border-radius: 5px;
        }

        .score-badge {
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 4px;
            color: white;
        }

        .warning-text {
            font-size: 12px;
            color: #999;
            margin-top: 20px;
            text-align: left;
            line-height: 1.4;
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 8px;
        }

        .desc-text {
            font-size: 14px;
            color: var(--secondary-text);
            margin-bottom: 20px;
        }

    </style>
</head>
<body>

<div class="container">
    <div id="welcome-section" class="card">
        <h1>SCL-90<br>心理健康自评量表</h1>
        <p class="desc-text">本量表共90个项目，包含10个心理健康因子。请根据您<b>最近一周</b>（包括今天）的实际感觉进行回答。</p>
        <div style="text-align: left; font-size: 14px; background: #f9f9f9; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
            <strong>评分标准：</strong><br>
            1. 没有：自觉无该项症状<br>
            2. 很轻：自觉有该项症状，但对您无实际影响<br>
            3. 中度：自觉有该项症状，对您有一定影响<br>
            4. 偏重：自觉常有该项症状，对您有相当程度影响<br>
            5. 严重：自觉该症状频度和强度都十分严重
        </div>
        <button class="btn" onclick="startQuiz()">开始测试</button>
    </div>

    <div id="quiz-section">
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="progress-text">进度: <span id="currentNum">1</span> / 90</div>
        
        <div class="question-card">
            <div class="question-text" id="questionText">题目加载中...</div>
            <div class="options-grid">
                <button class="option-btn" onclick="selectOption(1)">1 - 没有</button>
                <button class="option-btn" onclick="selectOption(2)">2 - 很轻</button>
                <button class="option-btn" onclick="selectOption(3)">3 - 中度</button>
                <button class="option-btn" onclick="selectOption(4)">4 - 偏重</button>
                <button class="option-btn" onclick="selectOption(5)">5 - 严重</button>
            </div>
        </div>
    </div>

    <div id="result-section" class="card">
        <h2>测试结果分析</h2>
        <p id="totalScoreInfo" class="desc-text"></p>
        
        <div id="factors-container">
            </div>

        <div class="warning-text">
            <strong>免责声明：</strong><br>
            本测试结果仅供参考，不能作为临床诊断依据。如果您的某个因子得分较高，或者感到明显的心理不适，建议咨询专业的心理医生或前往医院就诊。
        </div>
        <button class="btn" onclick="location.reload()" style="background-color: #666;">重新测试</button>
    </div>
</div>

<script>
    // SCL-90 题目数据
    const questions = [
        "1. 头痛", "2. 神经过敏，心中不踏实", "3. 头脑中有不必要的想法或字句盘旋", "4. 头晕或昏倒", "5. 对异性的兴趣减退",
        "6. 对旁人责备求全", "7. 感到别人能控制您的思想", "8. 责怪别人制造麻烦", "9. 忘性大", "10. 担心自己的衣饰整齐及仪态的端庄",
        "11. 容易烦恼和激动", "12. 胸痛", "13. 害怕空旷的场所或街道", "14. 感到自己的精力下降，活动减慢", "15. 想结束自己的生命",
        "16. 听到旁人听不到的声音", "17. 发抖", "18. 感到大多数人都不可信", "19. 胃口不好", "20. 容易哭泣",
        "21. 同异性相处时感到害羞不自在", "22. 感到受骗，中了圈套或有人想抓住您", "23. 无缘无故地突然感到害怕", "24. 自己不能控制地发脾气", "25. 怕单独出门",
        "26. 经常责怪自己", "27. 腰痛", "28. 感到难以完成任务", "29. 感到孤独", "30. 感到苦闷",
        "31. 过分担忧", "32. 对事物不感兴趣", "33. 感到害怕", "34. 您的感情容易受到伤害", "35. 旁人能知道您的私下想法",
        "36. 感到别人不理解您、不同情您", "37. 感到人们对您不友好，不喜欢您", "38. 做事必须做得很慢以保证做得正确", "39. 心跳得很厉害", "40. 恶心或胃部不舒服",
        "41. 感到比不上他人", "42. 肌肉酸痛", "43. 感到有人在监视您、谈论您", "44. 难以入睡", "45. 做事必须反复检查",
        "46. 难以作出决定", "47. 怕乘电车、公共汽车、地铁或火车", "48. 呼吸有困难", "49. 一阵阵发冷或发热", "50. 因为感到害怕而避开某些东西、场合或活动",
        "51. 脑子变空了", "52. 身体发麻或刺痛", "53. 喉咙有梗塞感", "54. 感到没有前途没有希望", "55. 不能集中注意力",
        "56. 感到身体的某一部分软弱无力", "57. 感到紧张或容易紧张", "58. 感到手或脚发重", "59. 想到死亡的事", "60. 吃得太多",
        "61. 当别人看着您或谈论您时感到不自在", "62. 有一些不属于您自己的想法", "63. 有想打人或伤害他人的冲动", "64. 醒得太早", "65. 必须反复洗手、点数目或触摸某些东西",
        "66. 睡得不稳不深", "67. 有想摔坏或破坏东西的冲动", "68. 有人与您为难", "69. 感到与别人格格不入", "70. 在公共场合（如商店、电影院、餐厅）感到不自在",
        "71. 感到任何事情都很困难", "72. 一阵阵恐惧或惊恐", "73. 感到在公共场合吃东西很不舒服", "74. 经常与人争论", "75. 单独一人时神经很紧张",
        "76. 别人对您的成绩没有作出恰当的评价", "77. 即使和别人在一起也感到孤单", "78. 感到坐立不安，心神不定", "79. 感到自己没有什么价值", "80. 感到熟悉的东西变成陌生或不象是真的",
        "81. 大叫或摔东西", "82. 害怕要在公共场合昏倒", "83. 感到别人想占您的便宜", "84. 为一些有关性的念头而很苦恼", "85. 认为您应该因为自己的过错而受到惩罚",
        "86. 感到要赶快把事情做完", "87. 感到自己的身体有严重问题", "88. 从未感到和其他人很亲近", "89. 感到有罪恶感", "90. 认为自己的脑子有毛病"
    ];

    // 因子归类（基于题号，从1开始，需在代码中减1）
    const factorMap = {
        "躯体化": [1, 4, 12, 27, 40, 42, 48, 49, 52, 53, 56, 58],
        "强迫症状": [3, 9, 10, 28, 38, 45, 46, 51, 55, 65],
        "人际关系敏感": [6, 21, 34, 36, 37, 41, 61, 69, 73],
        "抑郁": [5, 14, 15, 20, 22, 26, 29, 30, 31, 32, 54, 71, 79],
        "焦虑": [2, 17, 23, 33, 39, 57, 72, 78, 80, 86],
        "敌对": [11, 24, 63, 67, 74, 81],
        "恐怖": [13, 25, 47, 50, 70, 75, 82],
        "偏执": [8, 18, 43, 68, 76, 83],
        "精神病性": [7, 16, 35, 62, 77, 84, 85, 87, 88, 90],
        "饮食睡眠/其他": [19, 44, 59, 60, 64, 66, 89]
    };

    let currentQuestionIndex = 0;
    let answers = new Array(90).fill(0);

    function startQuiz() {
        document.getElementById('welcome-section').style.display = 'none';
        document.getElementById('quiz-section').style.display = 'block';
        window.scrollTo(0, 0);
        renderQuestion();
    }

    function renderQuestion() {
        document.getElementById('currentNum').innerText = currentQuestionIndex + 1;
        document.getElementById('questionText').innerText = questions[currentQuestionIndex];
        
        // 更新进度条
        const progress = ((currentQuestionIndex) / 90) * 100;
        document.getElementById('progressBar').style.width = progress + '%';
    }

    function selectOption(value) {
        answers[currentQuestionIndex] = value;
        
        if (currentQuestionIndex < 89) {
            currentQuestionIndex++;
            // 添加一点点延迟，让用户感觉到点击反馈
            setTimeout(() => {
                renderQuestion();
            }, 150);
        } else {
            showResults();
        }
    }

    function calculateResults() {
        let results = {};
        let totalScore = 0;

        // 计算总分
        answers.forEach(score => totalScore += score);

        // 计算因子分
        for (let factor in factorMap) {
            let sum = 0;
            let count = factorMap[factor].length;
            factorMap[factor].forEach(qIndex => {
                // 题目序号减1对应数组索引
                sum += answers[qIndex - 1];
            });
            results[factor] = (sum / count).toFixed(2);
        }

        return {
            totalScore: totalScore,
            factorScores: results
        };
    }

    function getLevelInfo(score) {
        score = parseFloat(score);
        if (score < 2) return { text: "正常", color: "#2ecc71", percent: (score/5)*100 };
        if (score < 3) return { text: "轻度", color: "#f1c40f", percent: (score/5)*100 };
        if (score < 4) return { text: "中度", color: "#e67e22", percent: (score/5)*100 };
        return { text: "重度", color: "#e74c3c", percent: (score/5)*100 };
    }

    function showResults() {
        document.getElementById('quiz-section').style.display = 'none';
        document.getElementById('result-section').style.display = 'block';
        window.scrollTo(0, 0);

        const data = calculateResults();
        const factorContainer = document.getElementById('factors-container');
        factorContainer.innerHTML = '';

        // 显示总分
        document.getElementById('totalScoreInfo').innerHTML = 
            `总分: <strong>${data.totalScore}</strong> (若总分超过160分，或任一因子分超过2分，建议关注心理健康)`;

        // 渲染因子列表
        for (let factor in data.factorScores) {
            const score = data.factorScores[factor];
            const info = getLevelInfo(score);
            
            const html = `
                <div class="result-item">
                    <div class="result-label">
                        <span>${factor}</span>
                        <span>
                            <span class="score-badge" style="background:${info.color}">${info.text}</span>
                            <span>${score}</span>
                        </span>
                    </div>
                    <div class="result-bar-bg">
                        <div class="result-bar-fill" style="width: ${info.percent}%; background-color: ${info.color};"></div>
                    </div>
                </div>
            `;
            factorContainer.innerHTML += html;
        }
    }
</script>

</body>
</html>